data_rank %>%
filter(year == "1987") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
mutate(pos = cumsum(percent)-(percent/2), year = "1987", field_of_study = str_wrap(data_labels_before$field_of_study, 18))
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = -0.5, size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = 0.5, size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
?geom_text
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = 0.2, size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = 0.5, size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.5, size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", face = "bold") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
View(data_labels_before)
data_labels_before <-
data_rank %>%
filter(year == "1987") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(rank) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
color = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")
)
View(data_labels_before)
data_labels_before <-
data_rank %>%
filter(year == "1987") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
) %>%
arrange(rank) %>%
mutate(color = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"))
data_labels_before[1,7] <- 0
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study, color = color), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold") +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_before <-
data_rank %>%
filter(year == "1987") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
) %>%
arrange(rank) %>%
mutate(color = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"))
data_labels_before[8,7] <- 0
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_before <-
data_rank %>%
filter(year == "1987") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
color = c("#6f5438", "#4f5157", "#828585", "#e68c7c", "#f5c04a", "#fd8f24", "#919c4c", "#c03728")
)
data_labels_before[1,7] <- 0
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_before <-
data_rank %>%
filter(year == "1987") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
color = c("#e68c7c", "#828585", "#fd8f24", "#919c4c", "#4f5157", "#f5c04a", "#6f5438", "#c03728")
)
data_labels_before[1,7] <- 0
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.15, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.17, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_after <-
data_rank %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
color = c("#e68c7c", "#828585", "#fd8f24", "#919c4c", "#4f5157", "#f5c04a", "#6f5438", "#c03728")
)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.18, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_after <-
data_rank %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(phds) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
color = c("#e68c7c", "#828585", "#fd8f24", "#919c4c", "#4f5157", "#f5c04a", "#6f5438", "#c03728")
)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.18, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
View(data_labels_after)
View(data_labels_after)
View(data_long)
data_labels_after <-
data_long %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(phds) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_before$field_of_study, 18),
color = c("#e68c7c", "#828585", "#fd8f24", "#919c4c", "#4f5157", "#f5c04a", "#6f5438", "#c03728")
)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.18, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
View(data_rank)
data_labels_after <-
data_rank %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(phds) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_after$field_of_study, 18),
color = c("#e68c7c", "#828585", "#fd8f24", "#919c4c", "#4f5157", "#f5c04a", "#6f5438", "#c03728")
)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.18, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_after <-
data_rank %>%
filter(year == "2017")
View(data_labels_after)
data_labels_after <-
data_rank %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(phds)
View(data_labels_after)
data_labels_after <-
data_rank %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(phds) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_after$field_of_study, 18),
color = c("#e68c7c", "#828585", "#fd8f24", "#919c4c", "#4f5157", "#f5c04a", "#6f5438", "#c03728")
)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.18, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
data_labels_after <-
data_rank %>%
filter(year == "2017") %>%
mutate(field_of_study = case_when(
field_of_study == "Mathematics and computer sciences" ~ "Math and computer sciences",
field_of_study == "Physical sciences and earth sciences" ~ "Physical and earth sciences",
TRUE ~ field_of_study
)) %>%
arrange(phds) %>%
mutate(pos = cumsum(percent)-(percent/2),
field_of_study = str_wrap(data_labels_after$field_of_study, 18),
color = c("#828585", "#e68c7c", "#c03728", "#fd8f24", "#4f5157", "#6f5438", "#919c4c", "#f5c04a")
)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.19, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.12, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual("Field of study", values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438")) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 5, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.2, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggsave("field_of_study_bump.png", device = "png", type = "cairo", height = 6, width = 12)
ggsave("field_of_study_bump.png", device = "png", type = "cairo", height = 8, width = 14)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.18, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggsave("field_of_study_bump.png", device = "png", type = "cairo", height = 7, width = 12)
ggplot(data_long, aes(x = year, y = percent, alluvium = field_of_study)) +
geom_alluvium(aes(fill = field_of_study, color = field_of_study), width = 0.25, alpha = 0.75, decreasing = FALSE) +
geom_text(data = data_labels_before, aes(x = year, y = pos, label = field_of_study), hjust = "right", nudge_x = -0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_before$color) +
geom_text(data = data_labels_after, aes(x = year, y = pos, label = field_of_study), hjust = "left", nudge_x = 0.2, size = 4, family = "Lato", fontface = "bold", color = data_labels_after$color) +
scale_fill_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_color_manual(values = c("#c03728", "#919c4c", "#fd8f24", "#f5c04a", "#e68c7c", "#828585", "#4f5157", "#6f5438"), guide = FALSE) +
scale_x_discrete(expand = c(0.185, 0)) +
theme_pomological(base_family="Lato", base_size = 14) +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
theme(plot.subtitle = element_text(face = "italic", size = 14),
plot.title = element_text(size = 18),
plot.caption = element_text(face = "italic", size = 8.5, vjust = 0.5, hjust = 1)) +
labs(x = "Year", y = "Bar order: rank\nBar width: Percent of PhDs awarded", title = "PhDs awarded by field of study", subtitle = "Engineering climbs; education tumbles; biology wins", caption = "Graphic: @W_R_Chase\nData: NCSES")
ggsave("field_of_study_bump.png", device = "png", type = "cairo", height = 7, width = 12)
